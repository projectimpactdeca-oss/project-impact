<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>CEO-S | Project IMPACT Platform</title>
        <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
        <script src="/socket.io/socket.io.js"></script>
        <style>
            /* --- 1. CORE VARIABLES & RESET --- */
            :root {
                --primary: rgb(130, 40, 65);
                --primary-light: rgba(130, 40, 65, 0.05);
                --primary-medium: rgba(130, 40, 65, 0.15);
                --primary-solid-light: #fdf2f4;
                --primary-dark: rgb(90, 25, 45);
                --primary-gradient: linear-gradient(135deg, rgb(130, 40, 65) 0%, rgb(80, 20, 35) 100%);
                --secondary: #059669;
                --secondary-light: #d1fae5;
                --secondary-dark: #064e3b;
                --text-dark: #0f172a;
                --text-gray: #64748b;
                --bg-body: #f8fafc;
                --white: #ffffff;
                --shadow-md: 0 4px 6px -1px rgba(130, 40, 65, 0.08);
                --shadow-float: 0 20px 25px -5px rgba(0, 0, 0, 0.2);
            }

            * { margin: 0; padding: 0; box-sizing: border-box; }

            body {
                font-family: 'Manrope', sans-serif;
                background-color: var(--bg-body);
                background-image: radial-gradient(var(--primary-medium) 1.5px, transparent 1.5px);
                background-size: 24px 24px;
                color: var(--text-dark);
                height: 100vh;
                overflow: hidden;
            }

            /* --- 2. LAYOUT --- */
            .app-layout { display: flex; height: 100vh; }

            .sidebar {
                width: 280px;
                background: rgba(255, 255, 255, 0.95);
                backdrop-filter: blur(10px);
                border-right: 1px solid #e2e8f0;
                display: flex;
                flex-direction: column;
                padding: 24px 16px;
                z-index: 20;
            }

            .logo-area {
                display: flex;
                align-items: center;
                gap: 15px;
                padding-bottom: 24px;
                border-bottom: 1px solid #f1f5f9;
                margin-bottom: 20px;
            }

            .nav-menu { flex: 1; display: flex; flex-direction: column; gap: 6px; }

            .nav-item {
                display: flex;
                align-items: center;
                gap: 12px;
                padding: 12px 16px;
                border-radius: 10px;
                color: var(--text-gray);
                font-weight: 600;
                cursor: pointer;
                transition: 0.2s;
            }

            .nav-item.active { background: var(--primary); color: white; }

            /* Admin Visibility Logic */
            .admin-feature { display: none; }
            body.admin-mode .admin-feature { display: block; }

            .user-profile {
                margin-top: auto;
                padding-top: 20px;
                border-top: 1px solid #f1f5f9;
            }

            .role-badge {
                font-size: 10px;
                padding: 2px 8px;
                border-radius: 4px;
                background: #e2e8f0;
                font-weight: 700;
                margin-top: 5px;
                display: inline-block;
            }

            body.admin-mode .role-badge { background: #fee2e2; color: #b91c1c; }

            .toggle-btn {
                width: 100%; margin-top: 10px; padding: 6px; 
                background: #f1f5f9; border: 1px solid #cbd5e1;
                border-radius: 6px; cursor: pointer; font-size: 11px; font-weight: 700;
            }

            /* --- 3. CHAT UI --- */
            .chat-widget {
                position: fixed; bottom: 30px; right: 30px;
                width: 60px; height: 60px; border-radius: 50%;
                background: var(--primary-gradient); color: white;
                display: flex; align-items: center; justify-content: center;
                cursor: pointer; box-shadow: var(--shadow-float); z-index: 1000;
            }

            .chat-panel {
                position: fixed; bottom: 100px; right: 30px;
                width: 350px; height: 450px; background: white;
                border-radius: 16px; box-shadow: var(--shadow-float);
                display: none; flex-direction: column; overflow: hidden; z-index: 1000;
            }

            .chat-header { background: var(--primary); color: white; padding: 15px; display: flex; justify-content: space-between; }
            .chat-messages { flex: 1; padding: 15px; overflow-y: auto; display: flex; flex-direction: column; gap: 10px; }
            .msg { padding: 8px 12px; border-radius: 12px; max-width: 80%; font-size: 14px; }
            .msg.coach { background: #f1f5f9; align-self: flex-start; }
            .msg.user { background: var(--primary); color: white; align-self: flex-end; }
            .chat-input { padding: 15px; border-top: 1px solid #eee; display: flex; gap: 8px; }
            .chat-input input { flex: 1; padding: 8px; border: 1px solid #ddd; border-radius: 8px; outline: none; }
            .chat-input button { background: var(--primary); color: white; border: none; padding: 8px 15px; border-radius: 8px; cursor: pointer; }

            /* Rest of your Dashboard styles... */
            .main-content { flex: 1; overflow-y: auto; padding: 32px 40px; }
            .card { background: white; border-radius: 16px; padding: 24px; box-shadow: var(--shadow-md); margin-bottom: 20px; }
        </style>
    </head>
    <body>
        <div class="app-layout">
            <nav class="sidebar">
                <div class="logo-area">
                    <div class="avatar">C</div>
                    <div>
                        <h2 style="font-size: 16px;">CEO-S Platform</h2>
                        <span id="roleLabel" class="role-badge">USER MODE</span>
                    </div>
                </div>

                <div class="nav-menu">
                    <div class="nav-item active">Dashboard</div>
                    <div class="nav-item">Portfolio</div>
                    <div class="nav-item admin-feature" style="color: var(--primary);">Admin Controls</div>
                </div>

                <div class="user-profile">
                    <p style="font-weight: 700; font-size: 14px;">Jane Doe</p>
                    <button class="toggle-btn" onclick="toggleMode()">Check/Switch to Admin</button>
                </div>
            </nav>

            <main class="main-content">
                <header style="margin-bottom: 20px;">
                    <h1>Welcome, Project Lead</h1>
                    <p>Track your project IMPACT progress here.</p>
                </header>

                <div class="card">
                    <h3>Project Status</h3>
                    <p>Current Milestone: 85% Complete</p>
                </div>

                <div class="card admin-feature" style="background: #fffaf0; border: 1px solid #fbd38d;">
                    <h3 style="color: #c05621;">Admin Analytics</h3>
                    <p>View sensitive user data and backend logs here.</p>
                </div>
            </main>
        </div>

        <div class="chat-widget" onclick="toggleChat()">ðŸ’¬</div>
        <div class="chat-panel" id="chatPanel">
            <div class="chat-header">
                <strong>Executive Coach</strong>
                <span onclick="toggleChat()" style="cursor:pointer">âœ•</span>
            </div>
            <div class="chat-messages" id="chatMessages">
                <div class="msg coach">Hi Jane! How can I help you today?</div>
            </div>
            <div class="chat-input">
                <input type="text" id="chatInput" placeholder="Type a message...">
                <button id="sendBtn">Send</button>
            </div>
        </div>

        <script>
            const socket = io();
            const input = document.getElementById('chatInput');
            const sendBtn = document.getElementById('sendBtn');
            const messages = document.getElementById('chatMessages');

            // 1. Sending messages
            function send() {
                const text = input.value.trim();
                if(text) {
                    // Send to server
                    socket.emit('clientMessage', { text: text, user: 'Jane' });
                    input.value = '';
                }
            }

            sendBtn.onclick = send;
            input.onkeydown = (e) => e.key === 'Enter' && send();

            // 2. Receiving messages
            socket.on('clientMessage', (data) => {
                const div = document.createElement('div');
                div.className = 'msg user';
                div.innerText = data.text;
                messages.appendChild(div);
                messages.scrollTop = messages.scrollHeight;
            });

            socket.on('coachMessage', (data) => {
                const div = document.createElement('div');
                div.className = 'msg coach';
                div.innerText = data.text;
                messages.appendChild(div);
                messages.scrollTop = messages.scrollHeight;
            });

            // UI Functions
            function toggleChat() {
                const panel = document.getElementById('chatPanel');
                panel.style.display = (panel.style.display === 'flex') ? 'none' : 'flex';
            }

            function toggleMode() {
                document.body.classList.toggle('admin-mode');
                const label = document.getElementById('roleLabel');
                label.innerText = document.body.classList.contains('admin-mode') ? "ADMIN MODE" : "USER MODE";
            }
        </script>
    </body>
</html>
